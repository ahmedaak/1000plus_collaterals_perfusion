# recode recanalization variable
allpts$Rekan[allpts$Rekan==0] <- "None" # no recanalization
allpts$Rekan[allpts$Rekan==1] <- "Full" # full recanalization
allpts$Rekan[allpts$Rekan==2] <- "Partial" # partial recanalization
allpts$Rekan <- factor(allpts$Rekan)
allpts$Rekan <- factor(allpts$Rekan,levels(allpts$Rekan)[c(1,3,2)])
# recode other categorical variables
allpts$sex[allpts$sex==1] <- "Male"
allpts$sex[allpts$sex==2] <- "Female"
allpts$sex <- factor(allpts$sex)
allpts$iv_tPR[allpts$iv_tPR==0] <- "No"
allpts$iv_tPR[allpts$iv_tPR==1] <- "Yes"
allpts$iv_tPR[allpts$iv_tPR==2] <- "Yes" # CHECK WITH KERSTEN IF THIS IS CORRECTLY CODED
allpts$iv_tPR <- factor(allpts$iv_tPR)
allpts$circulation[allpts$circulation==1] <- "Anterior"
allpts$circulation[allpts$circulation==2] <- "Posterior"
allpts$circulation <- factor(allpts$circulation)
allpts$higashida_change <- allpts$higashida_D2-allpts$higashida_D1
allpts$higashida_D1 <- factor(allpts$higashida_D1)
allpts$higashida_D2 <- factor(allpts$higashida_D2)
allpts$higashida_change <- factor(allpts$higashida_change)
# remove certain variables
allpts$no_recan_1 <- c()
allpts$VAR00002 <- c()
allpts$TSI_dich <- c()
# merge with variables defining occlusion location
occ_classfn <- read.table("occlusion_classfn.csv", header = T, sep=";")
allpts <- merge(allpts, occ_classfn, by = "ID")
# correctly code NaNs
allpts[allpts=="NaN"]<-NA
# Defines whether (T) or not (F) to show outliers in boxplots
OL = F
# descriptive stats
dfSummary(allpts[,c(3,4,13,15)], plain.ascii = F, style="grid", graph.col = F, varnumbers = F, valid.col=F)
allpts_cont <- allpts[,c(2,5,6:12,16:18,25,29,30)] # define continous variables
#stargazer(allpts_cont, type="html", median = T, iqr = T, digits = 1)
# plot recanalization according to reperfusion status
barplot(table(allpts$reperf, allpts$Rekan), legend.text = c("No reperfusion", "Reperfusion"), col=c("#1b9e77","#d95f02"), xlab="Recanalization", ylab="Number of patients", xpd=F,args.legend = list(x = "topleft"), ylim=c(0,80))
# cross-tabulation of recanalization/reperfusion
kable(table(allpts$reperf, allpts$Rekan)) %>%
kable_styling(full_width=F, position="center") %>%
add_header_above(c(" "=1, "Recanalization"=3)) %>%
group_rows("Reperfusion",1,2)
# test for differences between recanalization and reperfusion
print(chisq.test(table(allpts$reperf, allpts$Rekan)))
# test if circulation has influence on reperfusion in non-recanalizers
model_1 <- lmrob(allpts[allpts$Rekan=="None",]$relTmax_4_change~allpts[allpts$Rekan=="None",]$circulation)
# test if circulation has influence on reperfusion in non-recanalizers ADJUSTING FOR iv TPA
model_2 <- lmrob(allpts[allpts$Rekan=="None",]$relTmax_4_change~allpts[allpts$Rekan=="None",]$circulation*allpts[allpts$Rekan=="None",]$iv_tPR)
# test if circulation has influence on reperfusion in recanalizers (full OR partial)
model_3 <- lmrob(allpts[allpts$Rekan=="Full"|allpts$Rekan=="Partial",]$relTmax_4_change~allpts[allpts$Rekan=="Full"|allpts$Rekan=="Partial",]$circulation)
# test if circulation has influence on reperfusion in recanalizers (full OR partial) ADJUSTING FOR iv TPA
model_4 <- lmrob(allpts[allpts$Rekan=="Full"|allpts$Rekan=="Partial",]$relTmax_4_change~allpts[allpts$Rekan=="Full"|allpts$Rekan=="Partial",]$circulation*allpts[allpts$Rekan=="Full"|allpts$Rekan=="Partial",]$iv_tPR)
stargazer(model_1, model_2, model_3,model_4, type="html", align = F, style="all", single.row=T)
boxplot(relTmax_4_change~circulation, data=allpts, xlab="Circulation", ylab="Extent of reperfusion (%)", outline=OL)
# check assumptions of robust GLM
#par(mfrow=c(3,2))
#plot(lmrob(allpts$relTmax_4_change~allpts$Rekan + allpts$circulation + allpts$TSI + allpts$iv_tPR))
# perform robust GLM
model_5 <- lmrob(allpts$relTmax_4_change~allpts$Rekan + allpts$iv_tPR + allpts$TSI + allpts$HIR1 + allpts$higashida_D1)
# plot extent of reperfusion in different recanalization grades
par(mfrow=c(1,1))
boxplot(relTmax_4_change~Rekan, data=allpts, col=c("#1b9e77","#1b9e77"), ylab="Extent of reperfusion (%)", xlab="Recanalization", outline=OL)
stargazer(model_5, type="html", align = F, style="all", single.row=T)
plot(allpts$HIR1, allpts$DWIvol_d1, xlab="Hypoperfusion intensity ratio", ylab="DWI lesion volume on day 1 (mL)",col = alpha("black", 0.4), pch=16)
print(cor.test(allpts$HIR1, allpts$DWIvol_d1, method="spearman"))
plot(allpts$HIR1, allpts$NIHSS_ad, xlab="Hypoperfusion intensity ratio", ylab="NIHSS on admission",col = alpha("black", 0.4), pch=16)
print(cor.test(allpts$HIR1, allpts$NIHSS_ad, method="spearman"))
plot(allpts$HIR1, allpts$infarct_growth_D5FLAIR, xlab="Hypoperfusion intensity ratio", ylab="Absolute DWI lesion growth (mL)",col = alpha("black", 0.4), pch=16)
print(cor.test(allpts$HIR1, allpts$infarct_growth_D5FLAIR, method="spearman"))
plot(allpts$HIR1, allpts$rel_DWIgrowth, xlab="Hypoperfusion intensity ratio", ylab="Relative DWI lesion growth (%)",col = alpha("black", 0.4), pch=16)
print(cor.test(allpts$HIR1, allpts$rel_DWIgrowth, method="spearman"))
model_A <- lmrob(mRS_d90~NIHSS_ad + iv_tPR, data=allpts)
plot(allEffects(model_A), multiline=T, ci.style="bars")
model_B <- lmrob(mRS_d90~NIHSS_ad + iv_tPR + Rekan*reperf, data=allpts)
plot(allEffects(model_B), multiline=T, ci.style="bars")
model_C <- lmrob(mRS_d90~NIHSS_ad + iv_tPR + HIR1, data=allpts)
plot(allEffects(model_C), multiline=T, ci.style="bars")
model_D <- lmrob(mRS_d90~NIHSS_ad + iv_tPR + higashida_D1, data=allpts)
plot(allEffects(model_D), multiline=T, ci.style="bars")
stargazer(model_A, model_B, model_C, model_D, type="html", align = F, style="all", single.row=T)
model_A <- lmrob(rel_DWIgrowth~NIHSS_ad + iv_tPR, data=allpts)
plot(allEffects(model_A), multiline=T, ci.style="bars")
model_B <- lmrob(rel_DWIgrowth~NIHSS_ad + iv_tPR + Rekan*reperf, data=allpts)
plot(allEffects(model_B), multiline=T, ci.style="bars")
model_C <- lmrob(rel_DWIgrowth~NIHSS_ad + iv_tPR + HIR1, data=allpts)
plot(allEffects(model_C), multiline=T, ci.style="bars")
model_D <- lmrob(rel_DWIgrowth~NIHSS_ad + iv_tPR + higashida_D1, data=allpts)
plot(allEffects(model_D), multiline=T, ci.style="bars")
stargazer(model_A, model_B, model_C, model_D, type="html", align = F, style="all", single.row=T)
model_A <- lmrob(DWIgrowth~NIHSS_ad + iv_tPR, data=allpts)
plot(allEffects(model_A), multiline=T, ci.style="bars")
model_B <- lmrob(DWIgrowth~NIHSS_ad + iv_tPR + Rekan*reperf, data=allpts)
plot(allEffects(model_B), multiline=T, ci.style="bars")
model_C <- lmrob(DWIgrowth~NIHSS_ad + iv_tPR + HIR1, data=allpts)
plot(allEffects(model_C), multiline=T, ci.style="bars")
model_D <- lmrob(DWIgrowth~NIHSS_ad + iv_tPR + higashida_D1, data=allpts)
plot(allEffects(model_D), multiline=T, ci.style="bars")
stargazer(model_A, model_B, model_C, model_D, type="html", align = F, style="all", single.row=T)
model_A <- lmrob(infarct_growth_D5FLAIR~NIHSS_ad + iv_tPR, data=allpts)
plot(allEffects(model_A), multiline=T, ci.style="bars")
model_B <- lmrob(infarct_growth_D5FLAIR~NIHSS_ad + iv_tPR + Rekan*reperf, data=allpts)
plot(allEffects(model_B), multiline=T, ci.style="bars")
model_C <- lmrob(infarct_growth_D5FLAIR~NIHSS_ad + iv_tPR + HIR1, data=allpts)
plot(allEffects(model_C), multiline=T, ci.style="bars")
model_D <- lmrob(infarct_growth_D5FLAIR~NIHSS_ad + iv_tPR + higashida_D1, data=allpts)
plot(allEffects(model_D), multiline=T, ci.style="bars")
stargazer(model_A, model_B, model_C, model_D, type="html", align = F, style="all", single.row=T)
library(robust)
step.lmRob(model_D, trace=T)
step.lmRob(object = model_D, trace=T)
step.lmRob(object = model_D, trace=T, fast=F)
step.lmRob(object = model_D)
model_D
step.lmRob(object = Model_D)
step.lmRob(object = model_D)
step.lmRob(model_C)
install.packages("leaps")
library("leaps")
regsubsets(mRS_d90~NIHSS_ad + iv_tPR + higashida_D1, data=allpts)
plot)regsubsets(mRS_d90~NIHSS_ad + iv_tPR + higashida_D1, data=allpts),scale="adjr2")
plot(regsubsets(mRS_d90~NIHSS_ad + iv_tPR + higashida_D1, data=allpts),scale="adjr2")
plot(regsubsets(mRS_d90~NIHSS_ad + iv_tPR + higashida_D1, data=allpts),scale="bic")
regsubsets(model_C)
step(model_A)
model_x <- lmrob(rel_DWIgrowth~HIR1,data=allpts)
summary(model_x)
model_x <- lmrob(DWIgrowth~HIR1,data=allpts)
summary(model_x)
allpts$relTmax_4_change
BIC(model_A)
allpts[,2]
allpts[2]
open(allpts)
View(allpts)
stargazer(allpts_cont, type="html", median = T, iqr = T, digits = 1)
allpts_cont
?stargazer
stargazer(allpts_cont, type="html", median = T, iqr = T, digits = 1, summary=T)
stargazer(allpts_cont, type="html", median = T, iqr = T, digits = 1, summary=rep(T,length(my.list)))
stargazer(allpts_cont, type="html", median = T, iqr = T, digits = 1, summary=rep(T,length(allpts_cont)))
stargazer(allpts_cont, type="html", median = T, iqr = T, digits = 1, summary=rep(F,length(allpts_cont)))
install.packages(c("ade4", "AnalyzeFMRI", "ape", "broom", "car", "carData", "cli", "coda", "cowplot", "cubature", "data.table", "DescTools", "digest", "dplyr", "e1071", "emmeans", "evaluate", "expm", "flextable", "ggplot2", "ggpubr", "ggthemes", "glue", "highr", "htmlTable", "htmlwidgets", "httpuv", "igraph", "ipred", "jmvcore", "kernlab", "later", "lava", "lme4", "magic", "maptools", "matrixStats", "memisc", "mime", "miniUI", "ModelMetrics", "modeltools", "munsell", "mvtnorm", "nloptr", "openssl", "ordinal", "pander", "pillar", "pkgconfig", "pls", "processx", "R.matlab", "R.oo", "R.utils", "R6", "Rcpp", "RCurl", "reshape", "rjson", "rlang", "rmarkdown", "robustbase", "rstudioapi", "sandwich", "scales", "shiny", "sjlabelled", "sjmisc", "sm", "snakecase", "stringi", "stringr", "summarytools", "survey", "tensorA", "testthat", "TH.data", "tidyr", "tidyselect", "useful", "utf8", "vegan", "webshot", "xtable", "xts", "yaml", "zoo"))
install.packages(c("cluster", "foreign", "MASS", "Matrix", "mgcv", "nlme", "rpart", "survival"), lib="C:/Program Files/R/R-3.4.3/library")
install.packages(c("ade4", "AnalyzeFMRI", "ape", "broom", "car", "carData", "cli", "coda", "cowplot", "cubature", "data.table", "DescTools", "digest", "dplyr", "e1071", "emmeans", "evaluate", "expm", "flextable", "ggplot2", "ggpubr", "ggthemes", "glue", "highr", "htmlTable", "htmlwidgets", "httpuv", "igraph", "ipred", "jmvcore", "kernlab", "later", "lava", "lme4", "magic", "maptools", "matrixStats", "memisc", "mime", "miniUI", "ModelMetrics", "modeltools", "munsell", "mvtnorm", "nloptr", "openssl", "ordinal", "pander", "pillar", "pkgconfig", "pls", "processx", "R.matlab", "R.oo", "R.utils", "R6", "Rcpp", "RCurl", "reshape", "rjson", "rlang", "rmarkdown", "robustbase", "rstudioapi", "sandwich", "scales", "shiny", "sjlabelled", "sjmisc", "sm", "snakecase", "stringi", "stringr", "summarytools", "survey", "tensorA", "testthat", "TH.data", "tidyr", "tidyselect", "useful", "utf8", "vegan", "webshot", "xtable", "xts", "yaml", "zoo"))
install.packages(c("ade4", "AnalyzeFMRI", "ape", "broom", "car", "carData", "cli", "coda", "cowplot", "cubature", "data.table", "DescTools", "digest", "dplyr", "e1071", "emmeans", "evaluate", "expm", "flextable", "ggplot2", "ggpubr", "ggthemes", "glue", "highr", "htmlTable", "htmlwidgets", "httpuv", "igraph", "ipred", "jmvcore", "kernlab", "later", "lava", "lme4", "magic", "maptools", "matrixStats", "memisc", "mime", "miniUI", "ModelMetrics", "modeltools", "munsell", "mvtnorm", "nloptr", "openssl", "ordinal", "pander", "pillar", "pkgconfig", "pls", "processx", "R.matlab", "R.oo", "R.utils", "R6", "Rcpp", "RCurl", "reshape", "rjson", "rlang", "rmarkdown", "robustbase", "rstudioapi", "sandwich", "scales", "shiny", "sjlabelled", "sjmisc", "sm", "snakecase", "stringi", "stringr", "summarytools", "survey", "tensorA", "testthat", "TH.data", "tidyr", "tidyselect", "useful", "utf8", "vegan", "webshot", "xtable", "xts", "yaml", "zoo"))
install.packages(c("ade4", "AnalyzeFMRI", "ape", "broom", "car", "carData", "cli", "coda", "cowplot", "cubature", "data.table", "DescTools", "digest", "dplyr", "e1071", "emmeans", "evaluate", "expm", "flextable", "ggplot2", "ggpubr", "ggthemes", "glue", "highr", "htmlTable", "htmlwidgets", "httpuv", "igraph", "ipred", "jmvcore", "kernlab", "later", "lava", "lme4", "magic", "maptools", "matrixStats", "memisc", "mime", "miniUI", "ModelMetrics", "modeltools", "munsell", "mvtnorm", "nloptr", "openssl", "ordinal", "pander", "pillar", "pkgconfig", "pls", "processx", "R.matlab", "R.oo", "R.utils", "R6", "Rcpp", "RCurl", "reshape", "rjson", "rlang", "rmarkdown", "robustbase", "rstudioapi", "sandwich", "scales", "shiny", "sjlabelled", "sjmisc", "sm", "snakecase", "stringi", "stringr", "summarytools", "survey", "tensorA", "testthat", "TH.data", "tidyr", "tidyselect", "useful", "utf8", "vegan", "webshot", "xtable", "xts", "yaml", "zoo"))
?stargazer
update(stargazer)
update.packages(stargazer)
install.packages("stargazer")
effplot = N
effplot = "N"
effplot
plot(allpts$mRS_d90, HIR1)
plot(allpts$mRS_d90, allpts$HIR1)
plot(allpts$HIR1~allpts$mRS_d90)
boxplot(allpts$HIR1~allpts$mRS_d90)
boxplot(allpts$HIR1~allpts$mRS_d90, xlab="mRS (day 90)", ylab="HIR")
boxplot(allpts$mRS_d90~allpts$iv_tPR, xlab="mRS (day 90)", ylab="HIR")
boxplot(allpts$mRS_d90~allpts$Rekan, xlab="mRS (day 90)", ylab="HIR")
boxplot(allpts$mRS_d90~allpts$reperf, ylab="mRS (day 90)", xlab="Reperfusion")
boxplot(allpts$mRS_d90~allpts$reperf*allpts$Rekan, ylab="mRS (day 90)", xlab="Reperfusion")
boxplot(allpts$mRS_d90~allpts$Rekan*reperf, ylab="mRS (day 90)", xlab="Recanalization")
boxplot(allpts$mRS_d90~allpts$Rekan*allpts$reperf, ylab="mRS (day 90)", xlab="Recanalization")
boxplot(allpts$mRS_d90~allpts$Rekan*allpts$reperf, ylab="mRS (day 90)", xaxt=)
boxplot(mRS_d90~Rekan + reperf, data=allpts, col=c("#1b9e77","#1b9e77","#1b9e77","#d95f02","#d95f02","#d95f02"), ylab="mRS day 90", outline=OL, xaxt="n")
axis(side=1, at=c(1,2,3,4,5,6), labels=c("None","Partial","Full","None","Partial","Full"))
legend("topright", legend = c("Non-reperfused","Reperfused"), fill=c("#1b9e77","#d95f02"))
boxplot(mRS_d90~Rekan + reperf, data=allpts, col=c("#1b9e77","#1b9e77","#1b9e77","#d95f02","#d95f02","#d95f02"), ylab="mRS day 90", outline=OL, xaxt="n", xlab="Recanalization")
axis(side=1, at=c(1,2,3,4,5,6), labels=c("None","Partial","Full","None","Partial","Full"))
legend("topright", legend = c("Non-reperfused","Reperfused"), fill=c("#1b9e77","#d95f02"))
boxplot(allpts$higashida_D1~allpts$mRS_d90, xlab="mRS (day 90)", ylab="Higashida score")
boxplot(allpts$mRS_d90~allpts$higashida_D1, xlab="mRS (day 90)", ylab="Higashida score")
allpts$higashida_D1
allpts$higashida_D1==NA
boxplot(allpts$higashida_D1~allpts$mRS_d90, xlab="mRS (day 90)", ylab="Higashida score",xlim=c(0,4))
boxplot(allpts$mRS_d90~allpts$higashida_D1, xlab="mRS (day 90)", ylab="Higashida score", xlim=c(0,4))
boxplot(allpts$mRS_d90~allpts$higashida_D1, xlab="mRS (day 90)", ylab="Higashida score", xlim=c(1,4))
boxplot(allpts$mRS_d90~allpts$higashida_D1, xlab="mRS (day 90)", ylab="Higashida score", xlim=c(0,5))
boxplot(allpts$mRS_d90~allpts$higashida_D1, xlab="mRS (day 90)", ylab="Higashida score", xlim=c(0,6))
boxplot(allpts$mRS_d90~allpts$higashida_D1, xlab="mRS (day 90)", ylab="Higashida score", xlim=c(-0.5,5.5))
boxplot(allpts$mRS_d90~allpts$higashida_D1, xlab="mRS (day 90)", ylab="Higashida score", xlim=c(0.5,5.5))
boxplot(allpts$mRS_d90~allpts$higashida_D1, ylab="mRS (day 90)", xlab="Higashida score", xlim=c(0.5,5.5))
boxplot(allpts$mRS_d90~allpts$iv_tPR, ylab="mRS (day 90)", xlab="IV thrombolysis")
boxplot(allpts$mRS_d90, allpts$NIHSS_ad, xlab="NIHSS on admission", ylab="IV thrombolysis")
plot(allpts$mRS_d90, allpts$NIHSS_ad, xlab="NIHSS on admission", ylab="IV thrombolysis")
boxplot(allpts$mRS_d90, allpts$NIHSS_ad, xlab="NIHSS on admission", ylab="IV thrombolysis")
boxplot(allpts$mRS_d90~allpts$NIHSS_ad, xlab="NIHSS on admission", ylab="IV thrombolysis")
boxplot(allpts$NIHSS_ad~allpts$mRS_d90, xlab="NIHSS on admission", ylab="IV thrombolysis")
boxplot(allpts$relTmax_4_change~allpts$iv_tPR, ylab="Extent of reperfusion", xlab="IV thrombolysis")
boxplot(allpts$NIHSS_ad~allpts$relTmax_4_change, xlab="Extent of reperfusion", ylab="NIHSS on admission")
boxplot(allpts$relTmax_4_change~allpts$iv_tPR, ylab="Extent of reperfusion", xlab="IV thrombolysis", outline=OL)
plot(allpts$NIHSS_ad,allpts$relTmax_4_change, ylab="Extent of reperfusion", xlab="NIHSS on admission")
plot(allpts$NIHSS_ad,allpts$relTmax_4_change, ylab="Extent of reperfusion", xlab="NIHSS on admission", log="x")
plot(allpts$NIHSS_ad,allpts$relTmax_4_change, ylab="Extent of reperfusion", xlab="NIHSS on admission", log="xy")
plot(allpts$NIHSS_ad,allpts$relTmax_4_change, ylab="Extent of reperfusion", xlab="NIHSS on admission")
boxplot(relTmax_4_change~Rekan, data=allpts, ylab="Extent of reperfusion", outline=OL, xlab="Recanalization")
plot(allpts$HIR1,allpts$relTmax_4_change, xlab="HIR", ylab="Extent of reperfusion")
boxplot(allpts$relTmax_4_change~allpts$higashida_D1, ylab="Extent of reperfusion", xlab="Higashida score", xlim=c(0.5,5.5))
boxplot(allpts$relTmax_4_change~allpts$higashida_D1, ylab="Extent of reperfusion", xlab="Higashida score", xlim=c(0.5,5.5), outline=OL)
plot(allpts$NIHSS_ad,allpts$rel_DWIgrowth, ylab="Relative infarct growth (D1 - D2)", xlab="NIHSS on admission")
boxplot(allpts$rel_DWIgrowth~allpts$iv_tPR, ylab="Relative infarct growth (D1 - D2)", xlab="IV thrombolysis", outline=OL)
boxplot(rel_DWIgrowth~Rekan, data=allpts, ylab="Relative infarct growth (D1 - D2)", outline=OL, xlab="Recanalization")
plot(allpts$HIR1,allpts$rel_DWIgrowth, xlab="HIR", ylab="Relative infarct growth (D1 - D2)")
boxplot(allpts$rel_DWIgrowth~allpts$higashida_D1, ylab="Relative infarct growth (D1 - D2)", xlab="Higashida score", xlim=c(0.5,5.5), outline=OL)
boxplot(allpts$DWIgrowth~allpts$iv_tPR, ylab="Absolute infarct growth (D1 - D2)", xlab="IV thrombolysis", outline=OL)
plot(allpts$NIHSS_ad,allpts$DWIgrowth, ylab="Absolute infarct growth (D1 - D2)", xlab="NIHSS on admission")
boxplot(DWIgrowth~Rekan, data=allpts, ylab="Absolute infarct growth (D1 - D2)", outline=OL, xlab="Recanalization")
plot(allpts$HIR1,allpts$DWIgrowth, xlab="HIR", ylab="Absolute infarct growth (D1 - D2)")
boxplot(allpts$DWIgrowth~allpts$higashida_D1, ylab="Absolute infarct growth (D1 - D2)", xlab="Higashida score", xlim=c(0.5,5.5), outline=OL)
boxplot(allpts$infarct_growth_D5FLAIR~allpts$higashida_D1, ylab="Absolute infarct growth (D1 - D5)", xlab="Higashida score", xlim=c(0.5,5.5), outline=OL)
plot(allpts$HIR1,allpts$infarct_growth_D5FLAIR, xlab="HIR", ylab="Absolute infarct growth (D1 - D5)")
boxplot(infarct_growth_D5FLAIR~Rekan, data=allpts, ylab="Absolute infarct growth (D1 - D5)", outline=OL, xlab="Recanalization")
boxplot(allpts$infarct_growth_D5FLAIR~allpts$iv_tPR, ylab="Absolute infarct growth (D1 - D5)", xlab="IV thrombolysis", outline=OL)
plot(allpts$NIHSS_ad,allpts$infarct_growth_D5FLAIR, ylab="Absolute infarct growth (D1 - D5)", xlab="NIHSS on admission")
lines(allpts$higashida_D1, allpts$higashida_D2)
plot()
plot(allpts$higashida_D1, allpts$higashida_D2, type="l")
plot(allpts$higashida_D1, allpts$higashida_D2)
plot(allpts$higashida_D1~allpts$higashida_D2)
spineplot(allpts$higashida_D1, allpts$higashida_D2)
mosaicplot(allpts$higashida_D1, allpts$higashida_D2)
mosaicplot(allpts$higashida_D1, allpts$higashida_D2)
mosaicplot(complete.cases(allpts$higashida_D1), complete.cases(allpts$higashida_D2))
mosaicplot(complete.cases(allpts$higashida_D1), complete.cases(allpts$higashida_D2))
spineplot(allpts$higashida_D1, allpts$higashida_D2)
spineplot(complete.cases(allpts$higashida_D1), complete.cases(allpts$higashida_D2))
plot(allpts$higashida_D1, allpts$higashida_D2)
plot(allpts$higashida_D1, allpts$higashida_D2, type="p")
plot(allpts$higashida_D1, allpts$higashida_D2, type=".")
plot(allpts$higashida_D1, allpts$higashida_D2, type="l")
plot(allpts$higashida_D1, allpts$higashida_D2)
spineplot(allpts$higashida_D1, allpts$higashida_D2)
plot(allpts$higashida_D1)
summary.table(allpts_cont)
summary.table(table(allpts_cont))
allpts_cont
summary(allpts_cont)
describe(allpts_cont)
library(Hmisc)
describe(allpts_cont)
kable(describe(allpts_cont))
kable(allpts_cont)
library(kableExtra)
kable(allpts_cont)
kable(describe(allpts_cont))
summarize(allpts_cont)
summarize(allpts_cont, by = c("Age"))
install.packages("papeR")
library(papeR)
summarize(allpts_cont)
summarize(allpts)
summarize(allpts_cont)
summarize(allpts)
summarize(allpts, group = "Rekan")
summarize(allpts, group = "reperf")
kable(summarize(allpts_cont))
View(allpts)
allpts
which(colnames(allpts)=="vessel")
which(colnames(allpts)=="Tmax_D1_.2_volume")
which(colnames(allpts)=="HIR1")
boxplot(allpts$DWIgrowth~allpts$higashida_D2-allpts$higashida_D1, ylab="Absolute infarct growth (D1 - D2)", xlab="Higashida score D1", xlim=c(0.5,5.5), outline=OL)
boxplot(allpts$DWIgrowth~(allpts$higashida_D2-allpts$higashida_D1), ylab="Absolute infarct growth (D1 - D2)", xlab="Higashida score D1", xlim=c(0.5,5.5), outline=OL)
boxplot(allpts$DWIgrowth~allpts$higashida_change, ylab="Absolute infarct growth (D1 - D2)", xlab="Higashida score D1", xlim=c(0.5,5.5), outline=OL)
boxplot(allpts$DWIgrowth~allpts$higashida_change, ylab="Absolute infarct growth (D1 - D2)", xlab="Higashida score D1", outline=OL)
boxplot(allpts$infarct_growth_D5FLAIR~allpts$higashida_change, ylab="Absolute infarct growth (D1 - D2)", xlab="Higashida score D1", outline=OL)
aov(allpts$TSI~allpts$Rekan)
summary(aov(allpts$TSI~allpts$Rekan))
test <- summary(aov(allpts$TSI~allpts$Rekan))
test
test$Pr(>F)
boxplot(allpts$TSI~allpts$Rekan)
View(allpts)
lmrob(mRS_d90~Rekan*Tmax_6_reperf_rel, data=allpts, setting="KS2014")
library(robust)
lmrob(mRS_d90~Rekan*Tmax_6_reperf_rel, data=allpts, setting="KS2014")
library(robustbase)
lmrob(mRS_d90~Rekan*Tmax_6_reperf_rel, data=allpts, setting="KS2014")
plot(allEffects(model_A), multiline=T, ci.style="bars")
knitr::opts_chunk$set(echo = TRUE)
# necessary packages
library(robustbase)
library(knitr)
library(xtable)
library(Hmisc)
library(TOSTER)
library(stargazer)
library(summarytools)
library(magrittr)
library(kableExtra)
library(effects)
library(pwr)
library(papeR)
library(robust)
# DEFINE WHETHER YOU WANT EFFECTS PLOTS FOR MIXED MODELS
effplot = "Y"
# Define whether (T) or not (F) to show outliers in boxplots
OL = F
#if (file.exists("allpts.Rdata")){
#("allpts.Rdata")
#} else {
# load data
allpts <- read.table("all_data_v3.csv", header = T, sep=";")
colnames(allpts)[1] <- "ID"
# load volumetric data
auto_pts <- read.table("ALLVOLS_automated_AK_20180605.csv", header=T, sep=";") # patients automatically delineated
manual_pts <- read.table("ALLVOLS_manual_AK_20180605.csv", header=T, sep=";") # patients manually delineated
# remove # of voxels, keep only volumes (in mm3)
auto_pts <- auto_pts[,c(1,3,5,7,9,11,13)]
manual_pts <- manual_pts[,c(1,3,5,7,9,11,13)]
# convert volumes to mL (cm3)
auto_pts[,-1] <- auto_pts[,-1]*0.001
manual_pts[,-1] <- manual_pts[,-1]*0.001
# combine manual and automated volumes
vols_all_pts <- rbind(auto_pts, manual_pts)
# exclude subject 86 (not in Kersten's main dataset)
vols_all_pts <- vols_all_pts[!vols_all_pts$ID=="86",]
# calculate HIR for days 1 and 2
vols_all_pts$HIR1 <- vols_all_pts$Tmax_D1_.8_volume/vols_all_pts$Tmax_D1_.2_volume
vols_all_pts$HIR2 <- vols_all_pts$Tmax_D2_.8_volume/vols_all_pts$Tmax_D2_.2_volume
# merge volumes and HIR with the rest of the data
allpts <- merge(allpts, vols_all_pts, by = "ID")
# rename Tmax volume variables to include threshold (>6s)
allpts$Tmax_D1_.6_volume <- allpts$Tmax_vol_d1
allpts$Tmax_D2_.6_volume <- allpts$Tmax_vol_d2
# create reperfusion variables
allpts$Tmax_6_reperf_abs <- allpts$Tmax_D1_.6_volume - allpts$Tmax_D2_.6_volume
allpts$Tmax_6_reperf_rel <- (allpts$Tmax_6_reperf_abs/allpts$Tmax_D1_.6_volume)*100
# replace infinity values (divide by zero where D1 Tmax volume = 0) with NA
is.na(allpts$Tmax_6_reperf_rel)<-sapply(allpts$Tmax_6_reperf_rel, is.infinite)
# recode recanalization variable
allpts$Rekan[allpts$Rekan==0] <- "None" # no recanalization
allpts$Rekan[allpts$Rekan==1] <- "Full" # full recanalization
allpts$Rekan[allpts$Rekan==2] <- "Partial" # partial recanalization
allpts$Rekan <- factor(allpts$Rekan)
allpts$Rekan <- factor(allpts$Rekan,levels(allpts$Rekan)[c(2,3,1)])
# recode other categorical variables
allpts$sex[allpts$sex==1] <- "Male"
allpts$sex[allpts$sex==2] <- "Female"
allpts$sex <- factor(allpts$sex)
allpts$iv_tPR[allpts$iv_tPR==0] <- "No"
allpts$iv_tPR[allpts$iv_tPR==1] <- "Yes"
allpts$iv_tPR[allpts$iv_tPR==2] <- "Yes"
allpts$iv_tPR <- factor(allpts$iv_tPR)
allpts$circulation[allpts$circulation==1] <- "Anterior"
allpts$circulation[allpts$circulation==2] <- "Posterior"
allpts$circulation <- factor(allpts$circulation)
allpts$higashida_change <- allpts$higashida_D2-allpts$higashida_D1
allpts$higashida_D1 <- factor(allpts$higashida_D1)
allpts$higashida_D2 <- factor(allpts$higashida_D2)
allpts$higashida_change <- factor(allpts$higashida_change)
# remove certain variables
allpts$no_recan_1 <- c()
allpts$VAR00002 <- c()
allpts$TSI_dich <- c()
# merge with variables defining occlusion location
occ_classfn <- read.table("occlusion_classfn.csv", header = T, sep=";")
allpts <- merge(allpts, occ_classfn, by = "ID")
# correctly code NaNs
allpts[allpts=="NaN"]<-NA
# save data
save(allpts, file = "allpts.Rdata")
#}
model_A <- lmrob(Tmax_6_reperf_rel~NIHSS_ad + iv_tPR, data=allpts, setting = "KS2014")
boxplot(allpts$Tmax_6_reperf_rel~allpts$iv_tPR, ylab="Extent of reperfusion", xlab="IV thrombolysis", outline=OL)
plot(allpts$NIHSS_ad,allpts$Tmax_6_reperf_rel, ylab="Extent of reperfusion", xlab="NIHSS on admission")
model_B <- lmrob(Tmax_6_reperf_rel~NIHSS_ad + iv_tPR + Rekan, data=allpts, setting = "KS2014")
boxplot(Tmax_6_reperf_rel~Rekan, data=allpts, ylab="Extent of reperfusion", outline=OL, xlab="Recanalization")
model_C <- lmrob(Tmax_6_reperf_rel~NIHSS_ad + iv_tPR + HIR1 + Rekan, data=allpts, setting = "KS2014")
plot(allpts$HIR1,allpts$Tmax_6_reperf_rel, xlab="HIR", ylab="Extent of reperfusion")
model_D <- lmrob(Tmax_6_reperf_rel~NIHSS_ad + iv_tPR + higashida_D1_bin + Rekan, data=allpts, setting = "KS2014")
boxplot(allpts$Tmax_6_reperf_rel~allpts$higashida_D1_bin, ylab="Extent of reperfusion", xlab="Higashida score D1", xlim=c(0.5,2.5), outline=OL)
if (effplot == "Y") {
plot(allEffects(model_A), multiline=T, ci.style="bars")
plot(allEffects(model_B), multiline=T, ci.style="bars")
plot(allEffects(model_C), multiline=T, ci.style="bars")
plot(allEffects(model_D), multiline=T, ci.style="bars")
}
stargazer(model_A, model_B, model_C, model_D, type="html", align = F, style="all", single.row=T)
stargazer(anova(model_A,model_B), type="html", align = F, style="all", single.row=T, title = "1 vs 2")
stargazer(anova(model_A,model_C), type="html", align = F, style="all", single.row=T, title = "1 vs 3")
stargazer(anova(model_A,model_D), type="html", align = F, style="all", single.row=T, title = "1 vs 4")
allpts_nonrekan <- allpts[which(allpts$Rekan=="None"),]
model_A <- lmrob(Tmax_6_reperf_rel~NIHSS_ad + iv_tPR, data=allpts_nonrekan, setting = "KS2014")
boxplot(allpts_nonrekan$Tmax_6_reperf_rel~allpts_nonrekan$iv_tPR, ylab="Extent of reperfusion", xlab="IV thrombolysis", outline=OL)
plot(allpts_nonrekan$NIHSS_ad,allpts_nonrekan$Tmax_6_reperf_rel, ylab="Extent of reperfusion", xlab="NIHSS on admission")
model_B <- lmrob(Tmax_6_reperf_rel~NIHSS_ad + iv_tPR + HIR1, data=allpts_nonrekan, setting = "KS2014")
plot(allpts_nonrekan$HIR1,allpts_nonrekan$Tmax_6_reperf_rel, xlab="HIR", ylab="Extent of reperfusion")
model_C <- lmrob(Tmax_6_reperf_rel~NIHSS_ad + iv_tPR + higashida_D1_bin, data=allpts_nonrekan, setting = "KS2014")
boxplot(allpts_nonrekan$Tmax_6_reperf_rel~allpts_nonrekan$higashida_D1_bin, ylab="Extent of reperfusion", xlab="Higashida score D1", xlim=c(0.5,2.5), outline=OL)
if (effplot == "Y") {
plot(allEffects(model_A), multiline=T, ci.style="bars")
plot(allEffects(model_B), multiline=T, ci.style="bars")
plot(allEffects(model_C), multiline=T, ci.style="bars")
}
stargazer(model_A, model_B, model_C, type="html", align = F, style="all", single.row=T)
stargazer(anova(model_A,model_B), type="html", align = F, style="all", single.row=T, title = "1 vs 2")
stargazer(anova(model_A,model_C), type="html", align = F, style="all", single.row=T, title = "1 vs 3")
allpts_rekan <- allpts[which(allpts$Rekan=="Full" | allpts$Rekan=="Partial"),]
model_A <- lmrob(Tmax_6_reperf_rel~NIHSS_ad + iv_tPR, data=allpts_rekan, setting = "KS2014")
boxplot(allpts_rekan$Tmax_6_reperf_rel~allpts_rekan$iv_tPR, ylab="Extent of reperfusion", xlab="IV thrombolysis", outline=OL)
plot(allpts_rekan$NIHSS_ad,allpts_rekan$Tmax_6_reperf_rel, ylab="Extent of reperfusion", xlab="NIHSS on admission")
model_B <- lmrob(Tmax_6_reperf_rel~NIHSS_ad + iv_tPR + HIR1, data=allpts_rekan, setting = "KS2014")
plot(allpts_rekan$HIR1,allpts_rekan$Tmax_6_reperf_rel, xlab="HIR", ylab="Extent of reperfusion")
model_C <- lmrob(Tmax_6_reperf_rel~NIHSS_ad + iv_tPR + higashida_D1_bin, data=allpts_rekan, setting = "KS2014")
boxplot(allpts_rekan$Tmax_6_reperf_rel~allpts_rekan$higashida_D1_bin, ylab="Extent of reperfusion", xlab="Higashida score D1", xlim=c(0.5,2.5), outline=OL)
if (effplot == "Y") {
plot(allEffects(model_A), multiline=T, ci.style="bars")
plot(allEffects(model_B), multiline=T, ci.style="bars")
plot(allEffects(model_C), multiline=T, ci.style="bars")
}
stargazer(model_A, model_B, model_C, type="html", align = F, style="all", single.row=T)
stargazer(anova(model_A,model_B), type="html", align = F, style="all", single.row=T, title = "1 vs 2")
stargazer(anova(model_A,model_C), type="html", align = F, style="all", single.row=T, title = "1 vs 3")
model_A <- lmrob(mRS_d90~HIR1, data=allpts, setting = "KS2014")
boxplot(allpts$mRS_d90~allpts$iv_tPR, ylab="mRS (day 90)", xlab="IV thrombolysis")
boxplot(allpts$NIHSS_ad~allpts$mRS_d90, xlab="mRS (day 90)", ylab="NIHSS on admission")
model_B <- lmrob(mRS_d90~HIR1 + NIHSS_ad + iv_tPR + Rekan + Tmax_6_reperf_rel, data=allpts, setting = "KS2014")
boxplot(mRS_d90~Rekan, data=allpts, col=c("#1b9e77","#1b9e77","#1b9e77","#d95f02","#d95f02","#d95f02"), ylab="mRS day 90", outline=OL, xaxt="n", xlab="Recanalization")
axis(side=1, at=c(1,2,3,4,5,6), labels=c("Full","Partial","None","Full","Partial","None"))
legend("topright", legend = c("Non-reperfused","Reperfused"), fill=c("#1b9e77","#d95f02"))
model_C <- lmrob(mRS_d90~higashida_D1_bin, data=allpts, setting = "KS2014")
boxplot(allpts$HIR1~allpts$mRS_d90, xlab="mRS (day 90)", ylab="HIR")
model_D <- lmrob(mRS_d90~higashida_D1_bin + NIHSS_ad + iv_tPR  + Tmax_6_reperf_rel + Rekan, data=allpts, setting = "KS2014")
boxplot(allpts$mRS_d90~allpts$higashida_D1_bin, ylab="mRS (day 90)", xlab="Higashida score D1", xlim=c(0.5,2.5), outline=OL)
model_E <- lmrob(mRS_d90~Rekan*Tmax_6_reperf_rel, data=allpts, setting = "KS2014")
model_F <- lmrob(mRS_d90~Rekan*Tmax_6_reperf_rel + NIHSS_ad + iv_tPR, data=allpts, setting = "KS2014")
if (effplot == "Y") {
plot(allEffects(model_A), multiline=T, ci.style="bars")
plot(allEffects(model_B), multiline=T, ci.style="bars")
plot(allEffects(model_C), multiline=T, ci.style="bars")
plot(allEffects(model_D), multiline=T, ci.style="bars")
plot(allEffects(model_E), multiline=T, ci.style="bars")
plot(allEffects(model_F), multiline=T, ci.style="bars")
}
stargazer(model_A, model_B, model_C, model_D, model_E, model_F, type="html", align = F, style="all", single.row=T)
stargazer(anova(model_A,model_B), type="html", align = F, style="all", single.row=T, title = "1 vs 2")
stargazer(anova(model_C,model_D), type="html", align = F, style="all", single.row=T, title = "1 vs 3")
stargazer(anova(model_E,model_F), type="html", align = F, style="all", single.row=T, title = "1 vs 4")
model_A <- lmrob(DWIgrowth~HIR1, data=allpts, setting = "KS2014")
boxplot(allpts$DWIgrowth~allpts$iv_tPR, ylab="Absolute infarct growth (D1 - D2)", xlab="IV thrombolysis", outline=OL)
plot(allpts$NIHSS_ad,allpts$DWIgrowth, ylab="Absolute infarct growth (D1 - D2)", xlab="NIHSS on admission")
model_B <- lmrob(DWIgrowth~HIR1 + NIHSS_ad + iv_tPR + Tmax_6_reperf_rel + Rekan, data=allpts, setting = "KS2014")
boxplot(DWIgrowth~Rekan, data=allpts, ylab="Absolute infarct growth (D1 - D2)", outline=OL, xlab="Recanalization")
model_C <- lmrob(DWIgrowth~higashida_D1_bin, data=allpts, setting = "KS2014")
plot(allpts$HIR1,allpts$DWIgrowth, xlab="HIR", ylab="Absolute infarct growth (D1 - D2)")
model_D <- lmrob(DWIgrowth~higashida_D1_bin + NIHSS_ad + iv_tPR + Rekan + Tmax_6_reperf_rel, data=allpts, setting = "KS2014")
boxplot(allpts$DWIgrowth~allpts$higashida_D1_bin, ylab="Absolute infarct growth (D1 - D2)", xlab="Higashida score D1", xlim=c(0.5,2.5), outline=OL)
model_E <- lmrob(DWIgrowth~Rekan*Tmax_6_reperf_rel, data=allpts, setting = "KS2014")
model_F <- lmrob(DWIgrowth~Rekan*Tmax_6_reperf_rel + NIHSS_ad + iv_tPR, data=allpts, setting = "KS2014")
if (effplot == "Y") {
plot(allEffects(model_A), multiline=T, ci.style="bars")
plot(allEffects(model_B), multiline=T, ci.style="bars")
plot(allEffects(model_C), multiline=T, ci.style="bars")
plot(allEffects(model_D), multiline=T, ci.style="bars")
plot(allEffects(model_E), multiline=T, ci.style="bars")
plot(allEffects(model_F), multiline=T, ci.style="bars")
}
stargazer(model_A, model_B, model_C, model_D, model_E, model_F, type="html", align = F, style="all", single.row=T)
stargazer(anova(model_A,model_B), type="html", align = F, style="all", single.row=T, title = "1 vs 2")
stargazer(anova(model_C,model_D), type="html", align = F, style="all", single.row=T, title = "1 vs 3")
stargazer(anova(model_E,model_F), type="html", align = F, style="all", single.row=T, title = "1 vs 4")
model_A <- lmrob(infarct_growth_D5FLAIR~HIR1, data=allpts, setting="KS2014")
boxplot(allpts$infarct_growth_D5FLAIR~allpts$iv_tPR, ylab="Absolute infarct growth (D1 - D5)", xlab="IV thrombolysis", outline=OL)
plot(allpts$NIHSS_ad,allpts$infarct_growth_D5FLAIR, ylab="Absolute infarct growth (D1 - D5)", xlab="NIHSS on admission")
model_B <- lmrob(infarct_growth_D5FLAIR~HIR1 + NIHSS_ad + iv_tPR + Rekan + Tmax_6_reperf_rel, data=allpts, setting="KS2014")
boxplot(infarct_growth_D5FLAIR~Rekan, data=allpts, ylab="Absolute infarct growth (D1 - D5)", outline=OL, xlab="Recanalization")
model_C <- lmrob(infarct_growth_D5FLAIR~higashida_D1_bin, data=allpts, setting="KS2014")
plot(allpts$HIR1,allpts$infarct_growth_D5FLAIR, xlab="HIR", ylab="Absolute infarct growth (D1 - D5)")
model_D <- lmrob(infarct_growth_D5FLAIR~higashida_D1_bin + NIHSS_ad + iv_tPR  + Rekan + Tmax_6_reperf_rel, data=allpts, setting="KS2014")
boxplot(allpts$infarct_growth_D5FLAIR~allpts$higashida_D1_bin, ylab="Absolute infarct growth (D1 - D5)", xlab="Higashida score D1", xlim=c(0.5,2.5), outline=OL)
model_E <- lmrob(infarct_growth_D5FLAIR~Rekan*Tmax_6_reperf_rel, data=allpts, setting = "KS2014")
model_F <- lmrob(infarct_growth_D5FLAIR~Rekan*Tmax_6_reperf_rel + NIHSS_ad + iv_tPR, data=allpts, setting = "KS2014")
if (effplot == "Y") {
plot(allEffects(model_A), multiline=T, ci.style="bars")
plot(allEffects(model_B), multiline=T, ci.style="bars")
plot(allEffects(model_C), multiline=T, ci.style="bars")
plot(allEffects(model_D), multiline=T, ci.style="bars")
plot(allEffects(model_E), multiline=T, ci.style="bars")
plot(allEffects(model_F), multiline=T, ci.style="bars")
}
stargazer(model_A, model_B, model_C, model_D, model_E, model_F, type="html", align = F, style="all", single.row=T)
stargazer(anova(model_A,model_B), type="html", align = F, style="all", single.row=T, title = "1 vs 2")
stargazer(anova(model_C,model_D), type="html", align = F, style="all", single.row=T, title = "1 vs 3")
stargazer(anova(model_E,model_F), type="html", align = F, style="all", single.row=T, title = "1 vs 4")
model_A <- glmrob(higashida_D1_bin~NIHSS_ad + age + sex + TSI + DWIvol_d1 + circulation, data=allpts, family = "binomial")
if (effplot == "Y") {
plot(allEffects(model_A), multiline=T, ci.style="bars")
}
model_A <- glmrob(HIR1~NIHSS_ad + age + sex + TSI + DWIvol_d1 + circulation, data=allpts, family = "binomial")
if (effplot == "Y") {
plot(allEffects(model_A), multiline=T, ci.style="bars")
}
stargazer(model_A, type="html", align = F, style="all", single.row=T)
pwrtest
pwrtest$v + pwrtest$u
pwrtest$v + pwrtest$u + 1
?round
round(pwrtest$v + pwrtest$u + 1)
?summarize
?summarize
summarize(allpts)
summarize(allpts, type="factor")
kable(summarize(allpts, type="factor", variables=c("higashida_D1", "higashida_D2", "Rekan", "circulation", "sex", "iv_tPR")))
allpts[which(allpts$Rekan==allpts$Rekan=="Full"),]
allpts[which(allpts$Rekan=allpts$Rekan=="Full"),]
allpts[which(allpts$Rekan=="Full"),]
nrows(allpts[which(allpts$Rekan=="Full"),])
nrow(allpts[which(allpts$Rekan=="Full"),])
allpts$circulation
